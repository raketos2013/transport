@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model IEnumerable<LockInfoEntity>
@{
}

<div class="main-content">
    <div class="main-table grid" scrollable="">
        <div class="table-header-div">
            <table class="table-header">
                <colgroup>
                    <col style="min-width:170px;width:200px;">
                    <col style="min-width:135px;width:200px;">
                    <col style="min-width:140px;width:200px;">
                    <col style="min-width:140px;width:100%;">
                </colgroup>
                <thead>
                    <tr>
                        <th>
                            <p>Задача</p>
                            <div class="separate"></div>
                            <div class="sorter"></div>
                        </th>
                        <th>
                            <p>Пользователь</p>
                            <div class="separate"></div>
                            <div class="sorter"></div>
                        </th>
                        <th>
                            <p>Время</p>
                            <div class="separate"></div>
                            <div class="sorter"></div>
                        </th>
                        <th>

                        </th>
                    </tr>
                </thead>
            </table>
        </div>
        <div class="table-body-div">
            <table class="table-body" id="tableTasks">
                <colgroup>
                    <col style="min-width:170px;width:200px;">
                    <col style="min-width:135px;width:200px;">
                    <col style="min-width:140px;width:200px;">
                    <col style="min-width:140px;width:100%;">
                </colgroup>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td><p>@item.EntityId</p></td>
                            <td><p>@item.UserId</p></td>
                            <td><p>@item.Created</p></td>
                            <td>
                                <div class="group-btns-add">
                                    <div class="btn-add" onclick="ModalUnlockTask('@item.EntityId')">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.83332 19.5C7.37498 19.5 6.98276 19.3369 6.65665 19.0108C6.33054 18.6847 6.1672 18.2922 6.16665 17.8333V7C5.93054 7 5.73276 6.92 5.57332 6.76C5.41387 6.6 5.33387 6.40222 5.33332 6.16667C5.33276 5.93111 5.41276 5.73333 5.57332 5.57333C5.73387 5.41333 5.93165 5.33333 6.16665 5.33333H9.49998C9.49998 5.09722 9.57998 4.89944 9.73998 4.74C9.89998 4.58056 10.0978 4.50056 10.3333 4.5H13.6666C13.9028 4.5 14.1008 4.58 14.2608 4.74C14.4208 4.9 14.5005 5.09778 14.5 5.33333H17.8333C18.0694 5.33333 18.2675 5.41333 18.4275 5.57333C18.5875 5.73333 18.6672 5.93111 18.6666 6.16667C18.6661 6.40222 18.5861 6.60028 18.4266 6.76083C18.2672 6.92139 18.0694 7.00111 17.8333 7V17.8333C17.8333 18.2917 17.6703 18.6842 17.3441 19.0108C17.018 19.3375 16.6255 19.5006 16.1666 19.5H7.83332ZM10.3333 16.1667C10.5694 16.1667 10.7675 16.0867 10.9275 15.9267C11.0875 15.7667 11.1672 15.5689 11.1666 15.3333V9.5C11.1666 9.26389 11.0866 9.06611 10.9266 8.90667C10.7666 8.74722 10.5689 8.66722 10.3333 8.66667C10.0978 8.66611 9.89998 8.74611 9.73998 8.90667C9.57998 9.06722 9.49998 9.265 9.49998 9.5V15.3333C9.49998 15.5694 9.57998 15.7675 9.73998 15.9275C9.89998 16.0875 10.0978 16.1672 10.3333 16.1667ZM13.6666 16.1667C13.9028 16.1667 14.1008 16.0867 14.2608 15.9267C14.4208 15.7667 14.5005 15.5689 14.5 15.3333V9.5C14.5 9.26389 14.42 9.06611 14.26 8.90667C14.1 8.74722 13.9022 8.66722 13.6666 8.66667C13.4311 8.66611 13.2333 8.74611 13.0733 8.90667C12.9133 9.06722 12.8333 9.265 12.8333 9.5V15.3333C12.8333 15.5694 12.9133 15.7675 13.0733 15.9275C13.2333 16.0875 13.4311 16.1672 13.6666 16.1667Z" fill="var(--gray)" />
                                        </svg>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="modal-wrapper" id="modal-unlock-task">
    <div class="modal">
        <div class="modal-header">
            <p>Разблокировать задачу <span id="idTaskUnlockInfo"></span> ?</p>
            <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" onclick="CancelUnlockTask()">
                <path d="M5.19281 4.69635L8 7.50342L10.7926 4.71089C10.8543 4.64524 10.9286 4.59272 11.0111 4.55648C11.0936 4.52024 11.1825 4.50103 11.2726 4.5C11.4655 4.5 11.6505 4.57662 11.7869 4.713C11.9233 4.84938 11.9999 5.03435 11.9999 5.22722C12.0016 5.31638 11.985 5.40494 11.9513 5.48748C11.9175 5.57001 11.8672 5.64478 11.8035 5.70719L8.97452 8.49971L11.8035 11.3286C11.9234 11.4459 11.9937 11.6046 11.9999 11.7722C11.9999 11.9651 11.9233 12.15 11.7869 12.2864C11.6505 12.4228 11.4655 12.4994 11.2726 12.4994C11.1799 12.5033 11.0875 12.4878 11.0011 12.454C10.9147 12.4202 10.8363 12.3688 10.7708 12.3031L8 9.496L5.20008 12.2958C5.13863 12.3593 5.06522 12.4099 4.98409 12.4449C4.90296 12.4798 4.8157 12.4984 4.72737 12.4994C4.53449 12.4994 4.34951 12.4228 4.21313 12.2864C4.07674 12.15 4.00012 11.9651 4.00012 11.7722C3.99842 11.683 4.01497 11.5945 4.04873 11.5119C4.0825 11.4294 4.13277 11.3546 4.19648 11.2922L7.02548 8.49971L4.19648 5.67082C4.07661 5.55357 4.00633 5.39478 4.00012 5.22722C4.00012 5.03435 4.07674 4.84938 4.21313 4.713C4.34951 4.57662 4.53449 4.5 4.72737 4.5C4.90191 4.50218 5.06918 4.57272 5.19281 4.69635Z" fill="white" />
            </svg>
        </div>
        <div class="modal-body">
            <div class="modal-body-content">
            </div>
        </div>
        <div class="modal-footer">
            <div class="btn-full" onclick="OkUnlockTask()">
                Ок
            </div>
        </div>
    </div>
</div>

<script>
    window.addEventListener('load', () => {
        document.getElementById('menu-item-locked-tasks').style.backgroundColor = '#004830'
    });

    function ModalUnlockTask(taskId) {
        document.getElementById('idTaskUnlockInfo').innerText = taskId;
        ShowModal('modal-unlock-task');
    }
    function OkUnlockTask() {
        var taskId = document.getElementById('idTaskUnlockInfo').innerText;
        CloseModal('modal-unlock-task');
        $.ajax({
            method: 'POST',
            url: '/Task/UnlockTask',
            data: { "taskId": taskId },
            dataType: 'html',
            success: function (result) {
                location.reload();
            }
        });
    }
    function CancelUnlockTask() {
        document.getElementById('idTaskUnlockInfo').innerText = "";
        CloseModal('modal-unlock-task');
    }
</script>